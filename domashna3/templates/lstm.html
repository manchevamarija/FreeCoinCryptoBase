<!DOCTYPE html>
<html lang="mk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LSTM Прогноза | FreeCoinBase</title>

    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body {
            font-family: "Poppins", sans-serif;
            margin: 0;
            padding: 0;
            background: #fff;
            color: #111;
        }

        header.navbar {
            position: fixed;
            top: 0;
            width: 100%;
            background: #fff;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 0;
            border-bottom: 1px solid #ddd;
            z-index: 1000;
        }

        header.navbar .logo {
            font-weight: 700;
            font-size: 1.4rem;
            letter-spacing: 0.5px;
            color: #000;
        }

        header.navbar nav {
            display: flex;
            align-items: center;
            gap: 24px;
            flex-wrap: wrap;
        }

        header.navbar nav a {
            color: #000;
            text-decoration: none;
            font-weight: 500;
            transition: 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        header.navbar nav a:hover {
            color: #555;
        }

        header.navbar nav a.active {
            color: #0b592a;
            font-weight: 600;
        }

        .home-icon {
            width: 20px;
            height: 20px;
            vertical-align: middle;
            margin-right: 3px;
        }

        .lstm-section {
            padding: 8rem 2rem 4rem;
            max-width: 1000px;
            margin: 0 auto;
            text-align: center;
        }

        .lstm-section h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .lstm-controls {
            margin-top: 20px;
        }

        .lstm-controls select, .lstm-controls input, .lstm-controls button {
            padding: 8px 10px;
            margin: 5px;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-family: inherit;
        }

        .lstm-controls button {
            background: #0b592a;
            color: #fff;
            cursor: pointer;
        }

        canvas {
            margin-top: 2rem;
            max-width: 100%;
        }

        footer {
            background: #f5f5f5;
            padding: 3rem 1rem;
            margin-top: 3rem;
            border-top: 1px solid #ddd;
            text-align: center;
        }

        .footer-logo {
            font-size: 1.6rem;
            font-weight: 700;
            color: #0b592a;
            margin-bottom: 1rem;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .footer-links a {
            text-decoration: none;
            color: #0b592a;
            font-weight: 500;
            transition: 0.2s;
        }

        .footer-links a:hover {
            color: #063a1b;
        }
    </style>
</head>

<body>

<header class="navbar">
    <div class="logo">FreeCoinBase</div>
    <nav>
       <a href="/">Почетна</a>
<a href="/cryptos">База</a>
<a href="/grafici">Графици</a>
<a href="/lstm">LSTM анализа</a>
<a href="/sentiment">Сентимент анализа</a>
<a href="/on-chain">On-chain data</a>
<a href="/tech-analysis">Техничка анализа</a>
<a href="/analysis-view">Стратегиска анализа</a>
<a href="/za-nas">За Нас</a>

    </nav>
</header>

<section class="lstm-section">
    <h1>LSTM Прогноза</h1>
    <p>Избери криптовалута и временски период за LSTM предвидување.</p>

    <div class="lstm-controls">
<select id="coin">
    {% for coin in all_coins %}
        <option value="{{ coin.id }}"
            {% if selected_coin and coin.id == selected_coin.id %}selected{% endif %}>
            {{ coin.name }} ({{ coin.symbol }})
        </option>
    {% endfor %}
</select>


        <input type="number" id="value" min="1" value="7" style="width:80px;">

        <select id="unit">
            <option value="days">Денови</option>
            <option value="months">Месеци</option>
            <option value="years">Години</option>
        </select>

        <button onclick="runPrediction()">Прогнозирај</button>
    </div>

    <canvas id="lstmChart" width="900" height="400"></canvas>
</section>

<footer>
    <div class="footer-logo">FreeCoinBase</div>
    <div class="footer-links">
        <a href="/domashna3/static">Почетна</a>
        <a href="/cryptos">База</a>
        <a href="/grafici">Графици</a>
        <a href="/lstm">LSTM анализа</a>
        <a href="/sentiment">Сентимент анализа</a>
        <a href="/on-chain">On-chain data</a>
        <a href="/tech-analysis">Техничка анализа</a>
<a href="/analysis-view">Стратегиска анализа</a>
        <a href="/za-nas">За Нас</a>
    </div>
    <p style="margin-top:1rem; font-size:0.9rem; color:#555;">
        © 2025 FreeCoinBase — All rights reserved.
    </p>
</footer>

<script>
    let lstmChart = null;

    async function runPrediction() {
        const payload = {
            coin_id: document.getElementById("coin").value,
            horizon_type: document.getElementById("unit").value,
            horizon_value: parseInt(document.getElementById("value").value)
        };

        const res = await fetch("/lstm/predict", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify(payload)
        });

        const data = await res.json();

        const labels = [...data.history_dates, ...data.future_dates];
        const historyData = [...data.history_prices, ...Array(data.predictions.length).fill(null)];
        const futureData = [...Array(data.history_prices.length).fill(null), ...data.predictions];

        const ctx = document.getElementById("lstmChart").getContext("2d");
        if (lstmChart) lstmChart.destroy();

        lstmChart = new Chart(ctx, {
            type: "line",
            data: {
                labels: labels,
                datasets: [
                    {
                        label: "Вистинска цена",
                        data: historyData,
                        borderColor: "#0b592a",
                        backgroundColor: "rgba(11, 89, 42, 0.1)",
                        tension: 0.3
                    },
                    {
                        label: "LSTM предвидување",
                        data: futureData,
                        borderColor: "#EF476F",
                        borderDash: [6, 6],
                        backgroundColor: "rgba(239, 71, 111, 0.1)",
                        tension: 0.3
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {position: "top"},
                    title: {
                        display: true,
                        text: `LSTM Прогноза за ${data.symbol}`
                    }
                },
                scales: {
                    y: {
                        ticks: {callback: value => "$" + value.toLocaleString()}
                    }
                }
            }
        });
    }
</script>

</body>
</html>
