<!DOCTYPE html>
<html lang="mk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>On-Chain Crypto Opinions</title>
  <link rel="stylesheet" href="/static/css/style.css">
  <style>
    body { font-family: "Poppins", sans-serif; margin: 0; padding: 0; background: #fff; color: #111; }
    header.navbar { position: fixed; top: 0; width: 100%; background: #fff; display: flex; justify-content: space-between; align-items: center; padding: 18px 2rem; border-bottom: 1px solid #ddd; z-index: 1000; }
    header.navbar .logo { font-weight: 700; font-size: 1.4rem; color: #000; }
    header.navbar nav { display: flex; gap: 30px; }
    header.navbar nav a { color: #000; text-decoration: none; font-weight: 500; transition: 0.3s; display: flex; align-items: center; gap: 5px; }
    header.navbar nav a.active { color: #0b592a; font-weight: 600; }
    header.navbar nav a:hover { color: #555; }
    .home-icon { width: 20px; height: 20px; }
    .onchain-section { padding: 8rem 2rem 4rem; max-width: 1000px; margin: 0 auto; text-align: center; }
    .onchain-section h1 { font-size: 2rem; margin-bottom: 1rem; }
    table { margin-top: 2rem; border-collapse: collapse; width: 100%; }
    table th, table td { border: 1px solid #ddd; padding: 10px; text-align: center; }
    table th { background: #0b592a; color: #fff; }
    table tr:nth-child(even) { background: #f9f9f9; }
    footer { background: #f5f5f5; padding: 3rem 1rem; margin-top: 3rem; border-top: 1px solid #ddd; text-align: center; }
    .footer-logo { font-size: 1.6rem; font-weight: 700; color: #0b592a; margin-bottom: 1rem; }
    .footer-links { display: flex; justify-content: center; gap: 2rem; flex-wrap: wrap; }
    .footer-links a { text-decoration: none; color: #0b592a; font-weight: 500; transition: 0.2s; }
    .footer-links a:hover { color: #063a1b; }
    .input-group { margin-top: 2rem; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
    .input-group select, .input-group input { padding: 8px; border: 1px solid #aaa; border-radius: 6px; }
    .input-group button { padding: 8px 12px; background: #0b592a; color: #fff; border: none; cursor: pointer; border-radius: 6px; }
    .input-group button:hover { background: #063a1b; }
  </style>
</head>
<body>

<header class="navbar">
  <div class="logo">FreeCoinBase</div>
  <nav>
 <a href="/">Почетна</a>
<a href="/cryptos">База</a>
<a href="/grafici">Графици</a>
<a href="/lstm">LSTM анализа</a>
<a href="/sentiment">Сентимент анализа</a>
<a href="/on-chain">On-chain data</a>
<a href="/tech-analysis">Техничка анализа</a>
<a href="/analysis-view">Стратегиска анализа</a>
<a href="/za-nas">За Нас</a>

  </nav>
</header>

<section class="onchain-section">
  <h1>On-Chain Податоци за Крипто Монета</h1>
  <p>Избери или пребарај крипто монета и добиј мислења од API.</p>

  <div class="input-group">
    <label for="coinSelect">Избери:</label>
<select id="coinSelect">
  <option value="">-- одбери монета --</option>
  {% for coin in all_cryptos %}
    <option value="{{ coin.symbol }}">
      {{ coin.name }} ({{ coin.symbol }})
    </option>
  {% endfor %}
</select>


    <label for="coinSearch">или внеси:</label>
    <input type="text" id="coinSearch" placeholder="BTC, ETH...">
    <button id="fetchData">Fetch Opinions</button>
  </div>

  <table id="onchainTable">
    <thead>
      <tr>
        <th>Coin</th>
        <th>Opinion</th>
        <th>Sentiment</th>
        <th>Source</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</section>

<footer>
  <div class="footer-logo">FreeCoinBase</div>
  <div class="footer-links">
    <a href="/domashna3/static">Почетна</a>
    <a href="/cryptos">База</a>
    <a href="/grafici">Графици</a>
    <a href="/lstm">LSTM анализа</a>
    <a href="/sentiment">Сентимент анализа</a>
    <a href="/on-chain">On-chain data</a>
    <a href="/tech-analysis">Техничка анализа</a>
<a href="/analysis-view">Стратегиска анализа</a>
    <a href="/za-nas">За Нас</a>
  </div>
  <p style="margin-top: 1rem; font-size: 0.9rem; color: #555;">© 2025 FreeCoinBase — All rights reserved.</p>
</footer>

<script>
document.getElementById('fetchData').addEventListener('click', async () => {
  let coin = document.getElementById('coinSelect').value || document.getElementById('coinSearch').value.trim();
  if (!coin) {
    alert('Внесете или одберете монета');
    return;
  }

  try {
    const response = await fetch(`/api/onchain?coin=${encodeURIComponent(coin)}`);
    if (!response.ok) throw new Error('Network response was not ok');
    const data = await response.json();

    const tbody = document.querySelector('#onchainTable tbody');
    tbody.innerHTML = '';

    if (data.length === 0) {
      tbody.innerHTML = `<tr><td colspan="4">Нема податоци за ${coin.toUpperCase()}</td></tr>`;
      return;
    }

    data.forEach(d => {
      const row = `<tr>
        <td>${coin.toUpperCase()}</td>
        <td>${d.opinion}</td>
        <td>${d.sentiment}</td>
        <td>${d.source}</td>
      </tr>`;
      tbody.insertAdjacentHTML('beforeend', row);
    });
  } catch (error) {
    alert('Грешка при земање податоци од API');
    console.error(error);
  }
});
</script>

</body>
</html>